<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      
      #app {
        position: absolute; top: 0; right: 0; bottom: 0; left: 0;
      }
    </style>

    <title>Cesium Example</title>
  </head>
  <body>
    <div id="app">
    </div>
    <script type="module" >
     Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI5OTZhMmMzZC1lY2VlLTRlYzUtYTc5MC02OTk0Zjk3Y2Y0NjIiLCJpZCI6MTc0MjQyLCJpYXQiOjE2OTgzNjYyMjZ9.TN2DP64aepsTz5_W8tz12bSHNyD2jVoBVYreK0TZ0fA";
      const viewer = new Cesium.Viewer("container");
      // 3D Capture
      const assetsList = [2332701,2332703,2332890, 2332891, 2332892, 2332893	, 2332894 , 2332919,2332951, 
        2332957, 2332958, 2332959,  2332962, 2332963,2332964,2332965, 2332990, 2332991, 2332992,2333180, 2333208, 2333209	, 2333212, 
        2333216, 2333217,  2333218,2333221, 2333222	,  2333224, 2333229,2333234,2333239,2333244,  2333248,  2333251, 2333253, 2333256,
        2333257, 2333258,2333260,  2333261, 2333262,2333263, 2333265,  2333268, 2333274, 2333275, 2333278, 2333284, 2333291, 2333303, 2333305, 
        2333307,2333308, 2333309 ];
      let promiseArry = [];
      const setAssets = async () =>{
        try {
          promiseArry = assetsList.map(async ( asset, index)=>{

              // const tileset = await Cesium.Cesium3DTileset.fromIonAssetId(asset);
              const resource = await Cesium.IonResource.fromAssetId(asset);
              const tileset = await Cesium.Cesium3DTileset.fromUrl(resource, {
                // dynamicScreenSpaceError : false,
                // dynamicScreenSpaceErrorDensity : 0.00278,
                // dynamicScreenSpaceErrorFactor : 4.0,
                // dynamicScreenSpaceErrorHeightFalloff : 0.01,


                skipLevelOfDetail: true,  //email 내용 
                baseScreenSpaceError: 8000, //email 내용 
                skipScreenSpaceErrorFactor: 8,
                skipLevels: 1,
                // immediatelyLoadDesiredLevelOfDetail: false,
                // loadSiblings: false,
                // cullWithChildrenBounds: false,
                maximumScreenSpaceError: 15,
          });
          const extras = tileset.asset.extras;
        
          if (
            Cesium.defined(extras) &&
            Cesium.defined(extras.ion) &&
            Cesium.defined(extras.ion.defaultStyle)
          ) {
            tileset.style = new Cesium.Cesium3DTileStyle(extras.ion.defaultStyle);
          }
          await viewer.zoomTo(tileset);

          return viewer.scene.primitives.add(tileset);

        });
          try {
            // viewer.entities = entityCollection;
            await Promise.all(promiseArry);

          } catch (e) {
              // default value: empty array
            console.error('promise-all', e);
          }

        } catch (error) {
          console.log(error);
        }
      }
    setAssets();


    </script>

  </body>
</html>
