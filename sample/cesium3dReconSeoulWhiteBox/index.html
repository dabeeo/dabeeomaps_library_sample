<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      
      #app {
        position: absolute; top: 0; right: 0; bottom: 0; left: 0;
      }
    </style>

    <title>Cesium 3D Recon Seoul 106 whiteBox</title>
  </head>
  <body>
    <div id="app">
    </div>
    <script type="module" >
      Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlZjExOWQwMC1kYzAxLTRkMWItODlkYi1lZTBlZDMwODUxMDkiLCJpZCI6MTc0MDU5LCJpYXQiOjE3MDI0Mjk2OTd9.kXkbjmi5g_uc2C1W792H1eyzEYFcD7MJ2btivj4For0";
      const viewer = new Cesium.Viewer("app", { 
  // skyBox: false,
  // // 응답이 있어야 rendering update 되는 항목
  // // requestRenderMode: true,
  // baseLayerPicker: false,
  // geocoder: false,
  // homeButton: false,
  // infoBox: false,
  // sceneModePicker: false,
  // selectionIndicator: false,
  // // timeline: false,
  // navigationHelpButton: false,
  // navigationInstructionsInitiallyVisible: false,
  // scene3DOnly: true,
  // // 바닥 Image 설정
  // // globe: false,
  contextOptions: {
    webgl: {
      // antialias: true, // 안티 앨리어싱 사용
      depth: true, // 깊이 버퍼 사용
      // stencil: true, // 스텐실 버퍼 사용
      // premultipliedAlpha: true, // 사전 곱셈된 알파 사용
      // preserveDrawingBuffer: false, // 그리기 버퍼 유지
      failIfMajorPerformanceCaveat: true, // 성능 경고 무시
      powerPreference: "high-performance", // WebGL 드라이버에 성능 기반 설정 전달
      // pixelRatio: undefined, // 픽셀 비율
      webgl2: true, // WebGL 2 사용
    },
  },
});
let radian = 280.0;
let minus = 50.0;
viewer._cesiumWidget._creditContainer.style.display = "none";
      const assetsList = [ //  2648428,
      //2648423, 2648424, 2648425, 2648426, 2648427, 
     // 2648431, 2648432, 2648433, 2648435, 
     // 2648436, 2648438, 2648440, 2648442, 2648443, 
      // 2648445, 2648446, 2648448, 2648451, 2648453, 
      // 2648454, 2648455, 2648457, 2648458, 2648459, 
      // 2648460, 2648461, 2648463, 2648465, 2648466, 
      // 2648469, 2648471, 2648472, 2648473, 2648474, 
      // 2648475, 2648477, 2648478, 2648479, 2648480, 
      // 2648481, 2648482, 2648483, 2648484, 2648486, 
      // 2648487, 2648488, 2648696, 2648708, 2648709,
      // 2648710, 2648711, 2648712, 2648714, 2648716, 
      // 2648717, 2648719, 2648720, 2648722, 2648723,
      // 2648725, 2648727, 2648728, 2648729, 2648730,
      // 2648731, 2648732, 2648734, 2648736, 2648739,
      // 2648741, 2648743, 2648746, 2648747, 2648748, 
      // 2648749, 2648750, 2648751, 2648758, 2648769,
      // 2648771, 2648772, 2648773, 2648774, 2648775,
      // 2648776, 2648779, 2648780, 2648781, 2648782,
      // 2648783, 2648784, 2648785, 2648786, 2648788,
      // 2648789, 2648790, 2648791, 2648794, 2648795,
      // 2649015, 2649019, 2649020, 2649021, 2649033, 
      // 2649034, 2649035, 2649036, 2649037, 2649038, 
      // 2649040, 2649041, 2649042, 2649043, 2649047, 
      // 2649049
      2666151, 2666154, 2666156, 2666158, 2666161, 2666163, 2666165, 2666167,
  2666171, 2666173, 2666198, 2666200, 2666204, 2666206, 2666209, 2666213,
  2666220, 2666224, 2666235, 2666238, 2666242, 2666244, 2666247, 2666249,
  2666251, 2666254, 2666257, 2666260, 2666262, 2666264, 2666267, 2666272,
  2666274, 2666277, 2666281, 2666284, 2666286, 2666340, 2666360, 2666363,
  2666365, 2666367, 2666369, 2666372, 2666374, 2666377, 2666380, 2666384,
  2666388, 2666390, 2666392, 2666394, 2666396, 2666399, 2666402, 2666404,
  2666406, 2666409, 2666411, 2666414, 2666418, 2666422, 2666424, 2666426,
  2666428, 2666431, 2666433, 2666435, 2666438, 2666441, 2666444, 2666446,
  2666448, 2666450, 2666453, 2666456, 2666663, 2666665, 2666668, 2666671,
  2666675, 2666677, 2666733, 2666737, 2666742, 2666746, 2666751, 2666755,
  2666760, 2666764, 2666769, 2666774, 2666778, 2666781, 2666786, 2666788,
  2666791, 2666797, 2666803, 2666810, 2666817, 2666832, 2666838, 2666842,
  2666848, 2666857,
  2666874, 2666878, 2666881, 2666885, 2666889, 2666894,
  2666899, 2666907, 2666911, 2666915,
  2666150, 2666153, 2666155, 2666157, 2666159, 2666162, 2666164, 2666166,
  2666169, 2666172, 2666197, 2666199, 2666202, 2666205, 2666207, 2666210,
  2666218, 2666223, 2666233, 2666236, 2666240, 2666243, 2666245, 2666248,
  2666250, 2666253, 2666256, 2666258, 2666261, 2666263, 2666266, 2666271,
  2666273, 2666276, 2666278, 2666283, 2666285, 2666339, 2666358, 2666361,
  2666364, 2666366, 2666368, 2666371, 2666373, 2666376, 2666378, 2666382,
  2666387, 2666389, 2666391, 2666393, 2666395, 2666397, 2666401, 2666403,
  2666405, 2666408, 2666410, 2666412, 2666416, 2666420, 2666423, 2666425,
  2666427, 2666429, 2666432, 2666434, 2666437, 2666440, 2666442, 2666445,
  2666447, 2666449, 2666452, 2666455, 2666661, 2666664, 2666667, 2666670,
  2666673, 2666676, 2666678, 2666739, 2666741, 2666744, 2666748, 2666752,
  2666759, 2666762, 2666767, 2666773, 2666777, 2666779, 2666783, 2666787,
  2666789, 2666795, 2666800, 2666808, 2666816, 2666827, 2666837, 2666839,
  2666845, 2666853,
      ];
      let promiseArry = [];
        try {
          promiseArry = assetsList.map(async ( asset, index)=>{
            const resource = await Cesium.IonResource.fromAssetId(asset);
            const tileset = await Cesium.Cesium3DTileset.fromUrl(resource, {
              dynamicScreenSpaceErrorHeightFalloff: 0.01,
              skipLevelOfDetail: true, //email 내용
              baseScreenSpaceError: 8000, //email 내용
              skipScreenSpaceErrorFactor: 8,
              skipLevels: 1,
              maximumScreenSpaceError: 8,
            });
            const extras = tileset.asset.extras;
            if (
              Cesium.defined(extras) &&
              Cesium.defined(extras.ion) &&
              Cesium.defined(extras.ion.defaultStyle)
            ) {
              tileset.style = new Cesium.Cesium3DTileStyle(extras.ion.defaultStyle);
            }
            // await viewer.zoomTo(tileset);

            return viewer.scene.primitives.add(tileset);
          });
          try {
            // viewer.entities = entityCollection;
            await Promise.all(promiseArry);
          } catch (e) {
              // default value: empty array
            console.error('promise-all', e);
          }

        } catch (error) {
          console.log(error);
        }

        setTimeout(
        () =>
          viewer.camera.flyTo({
            destination: Cesium.Cartesian3.fromDegrees(127.147117, 37.511847, 800.0),
            orientation: {
              heading: Cesium.Math.toRadians(radian),
              pitch: Cesium.Math.toRadians(-35.0),
              roll: 0.0,
            },
          }),
        3000
      );
    </script>

  </body>
</html>
