<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.110/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      
      #app {
        position: absolute; top: 0; right: 0; bottom: 0; left: 0;
      }
    </style>

    <title>Cesium 3D Recon Seoul 106</title>
  </head>
  <body>
    <div id="app">
    </div>
    <script type="module" >
      Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlZjExOWQwMC1kYzAxLTRkMWItODlkYi1lZTBlZDMwODUxMDkiLCJpZCI6MTc0MDU5LCJpYXQiOjE3MDI0Mjk2OTd9.kXkbjmi5g_uc2C1W792H1eyzEYFcD7MJ2btivj4For0";
      const viewer = new Cesium.Viewer("app",{
       
        contextOptions: {
    webgl: {
      // antialias: true, // 안티 앨리어싱 사용
      depth: true, // 깊이 버퍼 사용
      // stencil: true, // 스텐실 버퍼 사용
      // premultipliedAlpha: true, // 사전 곱셈된 알파 사용
      // preserveDrawingBuffer: false, // 그리기 버퍼 유지
      failIfMajorPerformanceCaveat: true, // 성능 경고 무시
      powerPreference: "high-performance", // WebGL 드라이버에 성능 기반 설정 전달
      // pixelRatio: undefined, // 픽셀 비율
      webgl2: true, // WebGL 2 사용
    },
  },
      });
      viewer._cesiumWidget._creditContainer.style.display = "none";

      const assetsList = [
        2386135, 2387624, 2387625, 2387627, 2387628, 2387629, 2387632, 2387633,
        2387634, 2387635, 2387639, 2387647, 2387650, 2387651, 2387652, 2387655,
        2387719, 2387720, 2387721, 2387723, 2387724, 2387725, 2387728, 2387735,
        2387737, 2387775, 2387776, 2387777, 2387778, 2387779, 2387780, 2387781,
        2387782, 2387792, 2387794, 2387796, 2387797, 2387798, 2387800, 2387802,
        2387803, 2387804, 2387805, 2387806, 2387852, 2387855, 2387856, 2387858,
        2387861, 2387862, 2387863, 2387864, 2387865, 2387902, 2387903, 2387905,
        2387906, 2387911, 2387912, 2387913, 2387970, 2387972, 2387974, 2387978,
        2387979, 2387980, 2388059, 2388060, 2388063, 2388064, 2388065, 2388066,
        2388067, 2388068, 2388069, 2388170, 2388171, 2388172, 2388175, 2388176,
        2388177, 2388178, 2388179, 2388180, 2388183, 2388184, 2388185, 2388187,
        2388188, 2388189, 2388191, 2388192, 2388195, 2388197, 2388198, 2388200,
        2388201, 2388204, 2388209, 2388210, 2388211, 2388212, 2388213, 2388214,
        2388215, 2388216, 2388217, 2388218, 2388219, 2388220, 2388221, 2388222,
        2388223, 2388224, 2388225, 2388226, 2388227,
      ];
      let promiseArry = [];
        try {
          promiseArry = assetsList.map(async ( asset, index)=>{
            const resource = await Cesium.IonResource.fromAssetId(asset);
            const tileset = await Cesium.Cesium3DTileset.fromUrl(resource, {
              skipLevelOfDetail: true,  //email 내용 
              baseScreenSpaceError: 8000, //email 내용 
              skipScreenSpaceErrorFactor: 8,
              skipLevels: 1,
              maximumScreenSpaceError: 8,
            });
            const extras = tileset.asset.extras;
            if (
              Cesium.defined(extras) &&
              Cesium.defined(extras.ion) &&
              Cesium.defined(extras.ion.defaultStyle)
            ) {
              tileset.style = new Cesium.Cesium3DTileStyle(extras.ion.defaultStyle);
            }
            await viewer.zoomTo(tileset);

            return viewer.scene.primitives.add(tileset);
          });
          try {
            // viewer.entities = entityCollection;
            await Promise.all(promiseArry);
          } catch (e) {
              // default value: empty array
            console.error('promise-all', e);
          }

        } catch (error) {
          console.log(error);
        }
    </script>

  </body>
</html>
