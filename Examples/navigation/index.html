<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="../dabeeo_ci_symbol.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation</title>
    <style>
        body {
            margin: 0;
        }

        .map {
            width: 1000px;
            height: 500px;
        }
    </style>
</head>

<body>
    <button type="button" class="button-menu" name="getRoute">get route</button>
    <button type="button" class="button-menu" name="set">draw route</button>
    <button type="button" class="button-menu" name="clear">clear route</button>
    <button type="button" class="button-menu" name="start">start animation</button>
    <button type="button" class="button-menu" name="stop">stop animation</button>
    <div id='map' class="map"></div>
</body>
<script type="text/javascript" src='https://assets.dabeeomaps.com/upload/library/dabeeomaps-4.0-pre-release.js'></script><!-- change to official link  -->
<script>

    async function init () {
        const dabeeoMaps = new dabeeo.Maps();

        //fetch a map
        const mapData = await dabeeoMaps.getMapData({
            clientId: "75hb8YSnAokb-sZ04aDR91",
            clientSecret: "0f7ad84f160c7b3fd1849a7920af718b"
        });

        //get route information 
        const routeInfo = getRouteInformation(mapData);
        console.log(routeInfo);

        // render a map
        const mapOption = Object.assign({
            camera: "2d"

        });
        const mapContainer = document.getElementById('map');
        const map = await dabeeoMaps.showMap(mapContainer, mapOption, mapData);

        //initialize events
        initRouteEvent(map, routeInfo);

    }

    function getRouteInformation (data) {
        const routeOption = {
            origin: {
                poiId: "PO-WgCv1-qBo8094", // 사업전략부 (11 floor)
                floorId: "FL-t4vqgyek3jnb8146",
            },
            // destination: {
            //     poiId: "PO-NMvw3E0pe1690", // 플랫폼사업부 회의실 (11 floor )
            //     floorId: "FL-t4vqgyek3jnb8146"
            // },
            destination: {
                poiId: "PO-9InVzIGv20417", // 남자화장실 (2 floor )
                floorId: "FL-vf3q07spbmsw8132",
            }
        }
        return (data.getRoute(routeOption));
    }

    function drawRoute (map, routeInfo) {
    }

    function initRouteEvent (map, routeInfo) {
        document.querySelector("[name='set']").addEventListener('click', function () {
            const naviOption = {
                defaultLineOption: {
                    lineColor: "#0000ff",
                    solidLineEnabled: true,
                    solidLineWidth: 10,
                }, // 기본 주행선 옵션
            }
            map.routeSimulation.set(routeInfo, naviOption);
        });

        document.querySelector("[name='clear']").addEventListener('click', function () {
            map.routeSimulation.clear();
        })

        document.querySelector("[name='start']").addEventListener('click', function () {
            map.routeSimulation.start();
        });

        document.querySelector("[name='stop']").addEventListener('click', function () {
            map.routeSimulation.stop();
        })

    }

    init();


</script>

</html>