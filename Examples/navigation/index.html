<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id='viewport' class="viewport">
    <div class="inputContainer">
      <div class="routeBtn">Route</div>
      <div class="navBtn">Navigation</div>
      <div class="stopBtn">Stop</div>
      <div class="clearBtn">Clear</div>
    </div>
  </div>
</body>
<script type="text/javascript" src='https://assets.dabeeomaps.com/upload/library/dabeeomaps-4.0.0.js'></script>
<script>
  window.onload = function() {

    const dabeeoMaps = new dabeeo.Maps();
    dabeeoMaps.getMapData({
      clientId: "75hb8YSnAokb-sZ04aDR91",
      clientSecret: "0f7ad84f160c7b3fd1849a7920af718b",
    }).then( async (mapData) => {
      const mapContainer = document.getElementById('viewport');
      const mapOption = Object.assign({});
      const map = await dabeeoMaps.showMap(mapContainer, mapOption, mapData);

      const route = {
        origin: {
          poiId : "PO-4JvSQCWHC2270", // 남자화장실 (11층)
          floorId: "FL-t4vqgyek3jnb8146"
        },
        destination:  {
          poiId : "PO-M02DvTVjp8449", // 회의실1 (11층)
          floorId: "FL-t4vqgyek3jnb8146"
        },
        type: "recommendation",
        // type: "stairs",
        // type: "elevator",
        waypoints: [
          {
            poiId : "PO-NMvw3E0pe1690", // 플랫폼사업부 회의실 (11층)
            floorId: "FL-t4vqgyek3jnb8146"
          },
          {
            poiId : "PO-bG8eepPeB2502", // 여자화장실 (2층)
            floorId: "FL-vf3q07spbmsw8132" 
          }
        ],
        retResponse: true
      }

      document.querySelector('.routeBtn').addEventListener('click', function() {
        const naviOption = {
            lineColor:"#ff00ff",
            lineSpotSize: 12,
            lineZ : 200,
            speedRate: 50,
            solidLineEnabled: true,
            solidLineWidth: 3
        }

        map.routeSimulation.set(naviOption);
        map.routeSimulation.setRoute(route);
      });

      document.querySelector('.navBtn').addEventListener('click', function() {
        const animOption = {
            destOption:{
                activeDest: true,
                color: "#00ffff",
                opacity: 0.3,
                isAnimate: true,
                duration: 1200,
                isRepeat: true,
                isYoyo: false
            },
        };

        map.routeSimulation.draw(animOption);
      });

      document.querySelector('.stopBtn').addEventListener('click', function() {
        map.routeSimulation.stop();
      });

      document.querySelector('.clearBtn').addEventListener('click', function() {
        map.routeSimulation.clear();
      })
    });

  }
</script>
</html>